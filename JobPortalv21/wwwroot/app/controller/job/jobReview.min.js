var jobReview={init:function(){this.loadData();this.registerEvents()},registerEvents:function(){$("#ddlShowPage").on("change",function(){config.pageSize=$("#ddlShowPage :selected").text();config.pageIndex=1;$("#pagination-review").twbsPagination("destroy");jobReview.loadData()});$("#txt-review-keyword").on("keypress",function(n){n.which===13&&$("#btn-search-review").click()});$("#btn-search-review").off("click").on("click",function(){$("#pagination-review").twbsPagination("destroy");$("#ddlShowPage").prop("selectedIndex",0);config.pageSize=10;config.pageIndex=1;jobReview.loadData()});$("body").on("click",".btnUpdateReview",function(){var n=$(this).attr("data-id");$("#hid-review-id").val(n);$.ajax({type:"GET",url:"/Admin/JobFeedback/GetReview",data:{reviewId:n},beforeSend:common.runLoadingIndicator(),success:function(n){$("#modal-review").modal("show");$("#txt-email").val(n.Email);$("#txt-title").val(n.Name);$("#txt-review-content").val(n.Review);$("#ck-review-status").prop("checked",n.Status);$("#hid-review-date").val(n.CreatedDate);common.stopLoadingIndicator()}})});$("#btn-save-review").off("click").on("click",function(){var t=$("#hid-review-id").val(),n={};t!=undefined&&t!=""&&(n.Id=t,n.CreatedDate=$("#hid-review-date").val());n.Status=$("#ck-review-status").is(":checked")?1:0;n.Email=$("#txt-email").val();n.Name=$("#txt-title").val();n.Review=$("#txt-review-content").val();$.ajax({type:"POST",url:"/Admin/JobFeedback/UpdateReview",data:{jobReview:n},beforeSend:common.runLoadingIndicator(),success:function(n){n==!0?(common.notify("Save review success","success"),common.stopLoadingIndicator(),$("#modal-review").modal("hide"),jobReview.loadData()):(common.notify("Save review failed","error"),common.stopLoadingIndicator())}})})},loadData:function(){var n="",t=$("#tbl-review-template").html();$.ajax({type:"GET",url:"/Admin/JobFeedback/GetJobFeedbackPaging",data:{keyword:$("#txt-review-keyword").val(),page:config.pageIndex,pageSize:config.pageSize},beforeSend:common.runLoadingIndicator(),success:function(i){$.each(i.Result,function(i,r){var u={};u.Id=r.Id;u.Email=r.Email;u.Name=r.Name;u.Status=common.getStatusResponse(r.Status);u.CreatedDate=common.formatDateTime(r.CreatedDate);n+=Mustache.render(t,u)});$("#tbl-review-content").html(n);$("#lbl-total-review").html(i.RowCount);i.RowCount>0&&jobReview.pagination(i.RowCount);common.stopLoadingIndicator()}})},pagination:function(n){var t=Math.ceil(n/config.pageSize);$("#pagination-review").twbsPagination({totalPages:t,visiblePages:5,onPageClick:function(n,t){t!=config.pageIndex&&(config.pageIndex=t,jobReview.loadData())}})}};jobReview.init();