var contact={init:function(){this.loadData();this.registerEvents()},registerEvents:function(){$("#ddlShowPage").on("change",function(){config.pageSize=$("#ddlShowPage :selected").text();config.pageIndex=1;$("#pagination-contact").twbsPagination("destroy");contact.loadData()});$("#txt-contact-keyword").on("keypress",function(n){n.which===13&&$("#btn-search-contact").click()});$("#btn-search-contact").off("click").on("click",function(){$("#pagination-contact").twbsPagination("destroy");$("#ddlShowPage").prop("selectedIndex",0);config.pageIndex=1;config.pageSize=10;contact.loadData()});$("body").on("click",".btnUpdateContact",function(){var n=$(this).data("id");$("#hid-contact-id").val(n);$.ajax({type:"GET",url:"/Admin/Contact/GetContactDetails",data:{contactId:n},beforeSend:common.runLoadingIndicator(),success:function(n){$("#modal-contact").modal("show");$("#txt-email").val(n.Email);$("#txt-subject").val(n.Subject);$("#txt-content").text(n.Message);$("#ck-contact-status").prop("checked",n.Status);$("#hid-contact-date").val(n.CreatedDate);common.stopLoadingIndicator()},error:function(n){common.notify("Error: "+n,"error");common.stopLoadingIndicator()}})});$("#btn-save-contact").on("click",function(){var n={};n.Id=$("#hid-contact-id").val();n.Subject=$("#txt-subject").val();n.Email=$("#txt-email").val();n.Message=$("#txt-content").text();n.CreatedDate=$("#txt-contact-date").val();n.Status=$("#ck-contact-status").is(":checked")?1:0;$.ajax({type:"POST",url:"/Admin/Contact/SaveContact",data:{contactVm:n},beforeSend:common.runLoadingIndicator(),success:function(){$("#modal-contact").modal("hide");contact.loadData();common.stopLoadingIndicator()},error:function(n){common.notify("Error: "+n,"error");common.stopLoadingIndicator()}})});$("body").on("click",".btnDeleteContact",function(){var n=$(this).attr("data-id");common.confirm("Are you sure to delete?",function(){$.ajax({type:"POST",url:"/Admin/Contact/Delete",data:{contactId:n},success:function(){common.notify("Removed success.","success");contact.loadData()},error:function(n){common.notify("Error: "+n.Message,"error")}})})})},loadData:function(){var n="",t=$("#tbl-contact-template").html(),i=$("#txt-contact-keyword").val();$.ajax({type:"GET",url:"/Admin/Contact/GetAllPaging",data:{keyword:i,pageSize:config.pageSize,page:config.pageIndex},beforeSend:common.runLoadingIndicator(),success:function(i){$.each(i.Result,function(i,r){var u={};u.Id=r.Id;u.Subject=r.Subject;u.Email=r.Email;u.CreatedDate=common.formatDateTime(r.CreatedDate);u.Status=common.getStatusResponse(r.Status);n+=Mustache.render(t,u)});$("#tbl-contact-content").html(n);i.Total>0&&contact.paging(i.Total);$("#lbl-total-contact").html(i.Total);common.stopLoadingIndicator()},error:function(){common.notify("An error has occurred while loading data","error");common.stopLoadingIndicator()}})},paging:function(n){var t=Math.ceil(n/config.pageSize);$("#pagination-blog").twbsPagination({totalPages:t,visiblePages:5,onPageClick:function(n,t){t!=config.pageIndex&&(config.pageIndex=t,contact.loadData())}})}};contact.init();